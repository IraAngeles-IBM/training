language: go
go: 1.13.x

services:
- docker

before_install:
- wget https://github.com/google/protobuf/releases/download/v3.0.0/protoc-3.0.0-linux-x86_64.zip -O /tmp/protoc-3.0.0-linux-x86_64.zip
- unzip /tmp/protoc-3.0.0-linux-x86_64.zip -d protoc-3.0.0
- export PATH=$PATH:$PWD/protoc-3.0.0/bin/

install:
- curl -sL https://ibm.biz/idt-installer | bash
- echo "" > trainer/.env
- cd trainer
- make setup_classification
- make setup_object_detection
- make build

jobs:
  include:
    - stage: test
      script: cd trainer && make run_classification
    - stage: test
      script: cd trainer && make run_localization

    # - stage: deploy
    #   deploy:
    #   - provider: script
    #     skip_cleanup: true
    #     script: ./release.sh
    #     on:
    #       tags: true
    #       condition: $TRAVIS_OS_NAME = linux

    #   - provider: script
    #     skip_cleanup: true
    #     script: export DEPLOY_TO=production && cd docs && ./deploy.sh
    #     on:
    #       branch: master